.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_gallery_gravity_disturbance.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_gravity_disturbance.py:


Gravity Disturbances
====================

Gravity disturbances are the differences between the measured gravity and a reference
(normal) gravity produced by an ellipsoid. The disturbances are what allows
geoscientists to infer the internal structure of the Earth. We'll use the
:func:`harmonica.normal_gravity` function to calculate the global gravity disturbance of
the Earth using our sample gravity data.



.. image:: /gallery/images/sphx_glr_gravity_disturbance_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    <xarray.Dataset>
    Dimensions:          (latitude: 361, longitude: 721)
    Coordinates:
      * longitude        (longitude) float64 -180.0 -179.5 -179.0 ... 179.5 180.0
      * latitude         (latitude) float64 -90.0 -89.5 -89.0 ... 89.0 89.5 90.0
    Data variables:
        gravity          (latitude, longitude) float64 9.801e+05 ... 9.802e+05
        height_over_ell  (latitude, longitude) float64 1e+04 1e+04 ... 1e+04 1e+04
    Attributes:
        generating_institute:  gfz-potsdam
        generating_date:       2018/11/07
        product_type:          gravity_field
        body:                  earth
        modelname:             EIGEN-6C4
        max_used_degree:       1277
        filterlength:          1.0000 deg. (Gauss-Filter)
        flength_definition:    6sigma
        nhalf:                 405 (Transfer-Function T(nhalf)=1/2)
        tide_system:           tide_free
        functional:            gravity_ell (centrifugal term included)
        unit:                  mgal
        refsysname:            WGS84
        gmrefpot:              3.98600441800E+14 m**3/s**2
        radiusrefpot:          6378137.000 m
        flatrefpot:            3.352810664747480E-03 (1/298.25722356300)
        omegarefpot:           7.29211500000E-05 1/s
        long_lat_unit:         degree
        latlimit_north:        90.000000000000
        latlimit_south:        -90.000000000000
        longlimit_west:        -180.00000000000
        longlimit_east:        180.00000000000
        gridstep:              0.50000000000000
        height_over_ell:       10000.0000 m
        latitude_parallels:    361
        longitude_parallels:   721
        number_of_gridpoints:  260281
        gapvalue:              9999999.0000
        weighted_mean:         9.7667902E+05 mgal
        maxvalue:              9.8018358E+05 mgal
        minvalue:              9.7476403E+05 mgal
        signal_wrms:           1.5467865E+03 mgal
        grid_format:           long_lat_value
        attributes:            longitude latitude gravity_ell
        attributes_units:      deg. deg. mgal




|


.. code-block:: default

    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import harmonica as hm

    # Load the global gravity grid
    data = hm.datasets.fetch_gravity_earth()
    print(data)

    # Calculate normal gravity and the disturbance
    gamma = hm.normal_gravity(data.latitude, data.height_over_ell)
    disturbance = data.gravity - gamma

    # Make a plot of data using Cartopy
    plt.figure(figsize=(10, 10))
    ax = plt.axes(projection=ccrs.Orthographic(central_longitude=160))
    pc = disturbance.plot.pcolormesh(
        ax=ax, transform=ccrs.PlateCarree(), add_colorbar=False, cmap="seismic"
    )
    plt.colorbar(
        pc, label="mGal", orientation="horizontal", aspect=50, pad=0.01, shrink=0.5
    )
    ax.set_title("Gravity of disturbance of the Earth")
    ax.coastlines()
    plt.tight_layout()
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.590 seconds)


.. _sphx_glr_download_gallery_gravity_disturbance.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: gravity_disturbance.py <gravity_disturbance.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: gravity_disturbance.ipynb <gravity_disturbance.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
