.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_sample_data_earth_geoid.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_sample_data_earth_geoid.py:


Earth Geoid
===========

The geoid is the equipotential surface of the Earth's gravity potential that coincides
with mean sea level. It's often represented by "geoid heights", which indicate the
height of the geoid relative to the reference ellipsoid (WGS84 in this case). Negative
values indicate that the geoid is below the ellipsoid surface and positive values that
it is above. The data are on a regular grid with 0.5 degree spacing and was generated
from the spherical harmonic model EIGEN-6C4 [Forste_etal2014]_.



.. image:: /sample_data/images/sphx_glr_earth_geoid_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    <xarray.Dataset>
    Dimensions:    (latitude: 361, longitude: 721)
    Coordinates:
      * longitude  (longitude) float64 -180.0 -179.5 -179.0 ... 179.0 179.5 180.0
      * latitude   (latitude) float64 -90.0 -89.5 -89.0 -88.5 ... 89.0 89.5 90.0
    Data variables:
        geoid      (latitude, longitude) float64 -29.5 -29.5 -29.5 ... 15.37 15.37
    Attributes:
        generating_institute:  gfz-potsdam
        generating_date:       2018/12/13
        product_type:          gravity_field
        body:                  earth
        modelname:             EIGEN-6C4
        max_used_degree:       1277
        filterlength:          1.0000 deg. (Gauss-Filter)
        flength_definition:    6sigma
        nhalf:                 405 (Transfer-Function T(nhalf)=1/2)
        tide_system:           tide_free
        functional:            geoid
        zero_degree_term:      included
        unit:                  meter
        crust_density:         2670.0 kg/m**3
        refsysname:            WGS84
        gmrefpot:              3.98600441800E+14 m**3/s**2
        radiusrefpot:          6378137.000 m
        flatrefpot:            3.352810664747480E-03 (1/298.25722356300)
        omegarefpot:           7.29211500000E-05 1/s
        normal_potential:      6.263685171456948E+07 m**2/s**2
        long_lat_unit:         degree
        latlimit_north:        90.000000000000
        latlimit_south:        -90.000000000000
        longlimit_west:        -180.00000000000
        longlimit_east:        180.00000000000
        gridstep:              0.50000000000000
        latitude_parallels:    361
        longitude_parallels:   721
        number_of_gridpoints:  260281
        gapvalue:              999.0000
        weighted_mean:         -4.3554140E-02 meter
        maxvalue:              8.4722744E+01 meter
        minvalue:              -1.0625734E+02 meter
        signal_wrms:           3.0584191E+01 meter
        grid_format:           long_lat_value
        attributes:            longitude latitude geoid
        attributes_units:      deg. deg. meter




|


.. code-block:: default

    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import harmonica as hm

    # Load the geoid grid
    data = hm.datasets.fetch_geoid_earth()
    print(data)

    # Make a plot of data using Cartopy
    plt.figure(figsize=(10, 10))
    ax = plt.axes(projection=ccrs.Orthographic(central_longitude=100))
    pc = data.geoid.plot.pcolormesh(ax=ax, transform=ccrs.PlateCarree(), add_colorbar=False)
    plt.colorbar(
        pc, label="meters", orientation="horizontal", aspect=50, pad=0.01, shrink=0.6
    )
    ax.set_title("Geoid heights (EIGEN-6C4)")
    ax.coastlines()
    plt.tight_layout()
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.802 seconds)


.. _sphx_glr_download_sample_data_earth_geoid.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: earth_geoid.py <earth_geoid.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: earth_geoid.ipynb <earth_geoid.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
